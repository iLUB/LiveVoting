var xlvoVoter={init:function(c){var a=JSON.parse(c);var b=new RegExp("amp;","g");a.base_url=a.base_url.replace(b,"");this.config=a;this.ready=true;if(xlvoVoter.config.use_mathjax&&!!MathJax){MathJax.Hub.Config({"HTML-CSS":{scale:80}})}},config:{base_url:"",cmd_voting_data:"",lng:{player_seconds:"s"},debug:false},player:{frozen:true,active_voting_id:0,status:-1,countdown:0,has_countdown:false,countdown_classname:""},delay:1000,counter:0,forced_update:300,timeout:null,run:function(){this.loadVotingData();this.initElements()},initElements:function(){this.countdown_element=$("#xlvo_countdown");this.player_element=$("#xlvo_voter_player")},loadVotingData:function(){$.get(xlvoVoter.config.base_url,{cmd:"getVotingData"}).done(function(c){xlvoVoter.log(c);var e=(xlvoVoter.player.active_voting_id!=c.active_voting_id),d=(xlvoVoter.player.status!=c.status),b=(xlvoVoter.counter>xlvoVoter.forced_update),a=(xlvoVoter.player.frozen!=c.frozen);xlvoVoter.player=c;if(d||e||b||a){xlvoVoter.replaceHTML(xlvoVoter.handleCountdown())}else{xlvoVoter.handleCountdown()}xlvoVoter.timeout=setTimeout(xlvoVoter.loadVotingData,xlvoVoter.delay);xlvoVoter.counter++}).fail(function(){xlvoVoter.timeout=setTimeout(xlvoVoter.loadVotingData,xlvoVoter.delay)})},replaceHTML:function(a){xlvoVoter.log("replace");a=a?a:function(){};$.get(xlvoVoter.config.base_url,{cmd:"getHTML"}).done(function(b){xlvoVoter.player_element.replaceWith('<div id="xlvo_voter_player">'+b+"</div>");if(xlvoVoter.config.use_mathjax&&!!MathJax){MathJax.Hub.Queue(["Typeset",MathJax.Hub,"xlvo_voter_player"])}xlvoVoter.counter=0;xlvoVoter.player_element=$("#xlvo_voter_player");xlvoVoter.countdown_element=$("#xlvo_countdown");a()})},handleCountdown:function(){if(xlvoVoter.player.has_countdown){xlvoVoter.log("has countdown: "+(xlvoVoter.player.has_countdown?"yes, "+xlvoVoter.player.countdown:"no"));xlvoVoter.countdown_element.removeClass();xlvoVoter.countdown_element.text(xlvoVoter.player.countdown.toString()+" "+xlvoVoter.config.lng.player_seconds);xlvoVoter.countdown_element.show();xlvoVoter.countdown_element.addClass("label label-cd-"+xlvoVoter.player.countdown_classname)}else{xlvoVoter.countdown_element.removeClass();xlvoVoter.countdown_element.hide()}},log:function(c){if(xlvoVoter.config.debug){var b=new Error(),a=b.stack;console.log(c)}}};